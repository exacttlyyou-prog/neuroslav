# Инструкция по использованию потоковой записи встреч

## Подготовка

1. **Установите BlackHole** (если еще не установлен):
   ```bash
   brew install blackhole-2ch
   ```
   См. подробную инструкцию в `BLACKHOLE_SETUP.md`

2. **Настройте Multi-Output Device** в macOS (см. `BLACKHOLE_SETUP.md`)

3. **Убедитесь, что Ollama запущен**:
   ```bash
   ollama serve
   ```

## Использование

Запустите скрипт:
```bash
cd apps/api
source .venv/bin/activate
python scripts/record_meeting.py
```

## Как это работает

1. **Автоматическое обнаружение устройств**: Скрипт найдет микрофон и BlackHole (если установлен)

2. **Потоковая запись**: 
   - Запись идет непрерывно с обоих источников (микрофон + системный звук)
   - Каждые **30 секунд** автоматически извлекается чанк и отправляется на транскрипцию

3. **Асинхронная транскрипция**: 
   - Чанки транскрибируются в фоне через Whisper
   - Текст автоматически добавляется в Notion по мере готовности

4. **Остановка записи**:
   - Нажмите **ENTER** в терминале
   - Или **Ctrl+C**

5. **Финализация**:
   - После остановки все оставшиеся чанки транскрибируются
   - Генерируется саммари через Ollama
   - Полная транскрипция и саммари сохраняются в Notion
   - Отправляется уведомление в Telegram

## Результат

В Notion создается страница встречи с:
- Саммари (сгенерированное Ollama)
- Полной транскрипцией (по чанкам)
- Временными метками

## Примечания

- Первая загрузка модели Whisper займет ~2 минуты (только при первом запуске)
- Транскрипция каждого чанка занимает ~15-30 секунд (зависит от мощности Mac)
- Рекомендуется использовать модель Whisper "small" для баланса скорости/качества
