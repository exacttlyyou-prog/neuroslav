# План масштабной доработки Digital Twin

## Видение
Создание полноценного цифрового двойника-ассистента, который берет на себя рутину по встречам, задачам и ежедневному трекингу. Система должна работать проактивно (сама спрашивать, напоминать), а не только реактивно.

## Дизайн-код
**"Super Modern / Digital Twin"**:
- Темная тема по умолчанию.
- Glassmorphism (эффект матового стекла).
- Минимализм, крупная типографика.
- Анимации (Framer Motion).
- Grid-layout для дашборда.

---

## Фаза 1: Стабилизация ядра (Срочно)
Задача: Исправить текущие ошибки ("ошибка остановки записи") и обеспечить надежную базу.

1.  **Исправление записи встреч:**
    -   Добавить обработку сигналов (`SIGTERM`) в скрипт записи.
    -   Добавить проверку файл-флага остановки для надежности.
    -   Обеспечить корректное сохранение финализированных данных при остановке.
2.  **Оптимизация Notion интеграции:**
    -   Убедиться в стабильной работе фонового парсера.
    -   Устранить дублирование блоков.

## Фаза 2: Умный процесс встреч (Meeting Workflow)
Задача: Реализовать флоу "Запись -> Саммари -> Одобрение Админа -> Рассылка".

1.  **Telegram Approval Flow:**
    -   Бот присылает саммари Админу с кнопками: `[✅ Подтвердить и разослать]`, `[✏️ Редактировать]`.
    -   При нажатии `Подтвердить` -> рассылка участникам.
    -   При нажатии `Редактировать` -> бот ждет новый текст или инструкции.
2.  **Умное тегирование:**
    -   База контактов в Notion: `Имя` <-> `Telegram Username` / `Chat ID`.
    -   При генерации саммари LLM автоматически подставляет `@username` вместо имен.
3.  **Структура в Notion:**
    -   Создание отдельной записи в базе данных "Встречи".
    -   Свойства: Дата, Участники (Relation), Проекты (Relation), Статус.
    -   Контент: Toggle "Транскрипция" (свернуто), Саммари (развернуто), Задачи (To-do).

## Фаза 3: Агент задач и Ежедневный отчет (Task & Daily Agent)
Задача: Превратить систему из пассивной в активную.

1.  **Daily Check-in (18:30):**
    -   Cron-job (Scheduler) запускает опрос.
    -   Бот пишет: "Что удалось сделать за сегодня?".
    -   Парсинг ответа -> создание записей в Notion (Daily Log / Completed Tasks).
2.  **Декомпозиция задач:**
    -   User: "Нужно сделать презентацию по Q1".
    -   Agent: Декомпозирует на подзадачи (Собрать данные, Написать структуру, Дизайн, Ревью).
    -   Agent: Создает задачи в Notion/DB.
    -   Agent: Ставит напоминания (Pings).
3.  **Система Пингов:**
    -   Фоновый процесс проверяет дедлайны и "забытые" задачи.
    -   Ненавязчивые напоминания в Telegram: "Кажется, мы забыли про задачу X, она все еще актуальна?".

## Фаза 4: Супер-современный Фронтенд (UI/UX)
Задача: Сделать интерфейс, которым приятно пользоваться.

1.  **Дашборд (Главная):**
    -   Виджет "Текущий статус" (Запись / Ожидание).
    -   Виджет "Активные задачи" (Список с чекбоксами).
    -   Виджет "Последние встречи" (Карточки).
2.  **Страница Встречи:**
    -   Красивый плеер (если есть аудио).
    -   Разделение экрана: Транскрипция | Саммари + Задачи.
    -   Чат с контекстом встречи (RAG).
3.  **Технологии:**
    -   Next.js 14+ (App Router).
    -   Tailwind CSS + Shadcn UI.
    -   Framer Motion (анимации появления).
    -   Lucide Icons.

## Фаза 5: RAG и "Второй мозг"
Задача: Объединить все данные в единый контекст.

1.  **Единый векторный индекс:**
    -   Встречи + Задачи + Документы Notion.
2.  **Контекстный поиск:**
    -   В чате можно спросить: "О чем мы договорились с Колей на прошлой неделе?".
    -   Система ищет по вектору и дает точный ответ с ссылкой на встречу.

---
**Итог:** Мы переходим от простого "рекордера" к полноценному AI-ассистенту с человеческим лицом (Telegram Bot) и мощным мозгом (RAG + Notion).
