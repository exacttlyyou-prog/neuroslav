"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—Å—Ç—Ä–µ—á–∏ —á–µ—Ä–µ–∑ MCP Notion.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —á–µ—Ä–µ–∑ MCP Notion –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.
"""
import asyncio
import sys
from pathlib import Path

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –ø—É—Ç—å
root_dir = Path(__file__).parent
sys.path.insert(0, str(root_dir))

from dotenv import load_dotenv
from telegram import Bot
from loguru import logger

from core.config import get_settings
from core.ai_service import OllamaClient
from core.context_loader import ContextLoader
from core.rag_service import LocalRAG
from core.schemas import MeetingAnalysis
from services.notion_service import NotionService

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

# –ö–æ–Ω—Ç–µ–Ω—Ç, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —á–µ—Ä–µ–∑ MCP Notion (–≤—Å—Ç–∞–≤–ª–µ–Ω –≤—Ä—É—á–Ω—É—é)
MCP_CONTENT = """Here is the result of "view" for the Page with URL {{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9}} as of 2026-01-19T13:37:49.875Z:
<page url="{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9}}">
<ancestor-path>
<parent-page url="{{https://www.notion.so/d0edbf7095884065942c779f1f565dc0}}" title="–î–µ–Ω—å–≥–∏ –∏ –¥–µ–ª–∞ "/>
</ancestor-path>
<properties>
{"title":"–í—Å—Ç—Ä–µ—á–∏ –ê–ª—å—Ñ–∞ 2026"}
</properties>
<content>
/
<empty-block/>
<meeting-notes>
\t**–°–∏–Ω–∫ –ø–æ –∫–æ–Ω–≤–µ–π–µ—Ä—É –∏ —Ç–µ–∫—É—â–∏–º –∑–∞–¥–∞—á–∞–º** <mention-date start="2026-01-19"/>
\t<summary>
\t\t### –ü—Ä–æ–±–ª–µ–º—ã —Å –º–µ—Ö–∞–Ω–∏–∫–æ–π –±–∞—Ä–∞–±–∞–Ω–∞
\t\t- –ö–æ–º–∞–Ω–¥–∞ –æ–±—Å—É–¥–∏–ª–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –º–µ—Ö–∞–Ω–∏–∫–∏ "–±–∞—Ä–∞–±–∞–Ω–∞" –¥–ª—è –∫—ç—à–±—ç–∫–∞ - –¥–∞–∂–µ –Ω–µ–æ–±—É—á–µ–Ω–Ω—ã–π ChatGPT –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ –ø–æ–Ω—è–ª –±—Ä–∏—Ñ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718002a94ed9a2e7d106f0}}]
\t\t- –ú–µ—Ö–∞–Ω–∏–∫–∞ —Å –¥–∞—Ç–∞–º–∏ –∏ —Ä–æ—Ç–∞—Ü–∏–µ–π –æ–∫–∞–∑–∞–ª–∞—Å—å —Å–ª–æ–∂–Ω–æ–π –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
\t\t### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è UX –∫–æ–Ω–≤–µ–π–µ—Ä–∞
\t\t- **–í—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–∏–π—Å—è —Å–ø–∏—Å–æ–∫ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ —Å–∫—Ä–æ–ª–ª–∏—Ç—å –≤–µ—Å—å –¥–æ–∫—É–º–µ–Ω—Ç –≤ –ø–æ–∏—Å–∫–∞—Ö –Ω—É–∂–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180919691cc2f45a62793}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180328044c97d30d69fb2}}]
\t\t- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±—Ä–∏—Ñ–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –≤—Ä—É—á–Ω—É—é [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180328044c97d30d69fb2}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180eb810bce783ee48bec}}]
\t\t- **–°—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤**: –ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371801a91b8fa4a8632469b}}]
\t\t- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –æ–±–∑–æ—Ä–æ–º**: –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É summary, –≥–¥–µ –≤—Å–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (–±–∞–Ω–Ω–µ—Ä—ã, –ø–∏—Å—å–º–∞ –∏ —Ç.–¥.) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718002a019d02664105963}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180968e85fd1542d297ca}}]
\t\t- **–ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π**: –í—ã–¥–µ–ª—è—Ç—å –∫—Ä–∞—Å–Ω—ã–º –∏–ª–∏ –¥—Ä—É–≥–∏–º —Å–ø–æ—Å–æ–±–æ–º —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –ª–∏–º–∏—Ç—ã —Å–∏–º–≤–æ–ª–æ–≤ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371803b8486fdf1abbc892a}}]
\t\t- –ü–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä—É Editor.js - –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ –≤–æ–∑–Ω–∏–∫–ª–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371806fba61d096a895b088}}]
\t\t### –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á
\t\t- –£ –î–∞–Ω–∏ –æ—Å—Ç–∞–ª–∞—Å—å –æ–¥–Ω–∞ —Å—Ç–∞—Ä–∞—è –∑–∞–¥–∞—á–∞ –∏ —Ç—Ä–∏ –Ω–æ–≤—ã–µ –±–æ–µ–≤—ã–µ –∑–∞–¥–∞—á–∏, –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤ –±–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180939076dd6e19484cbf}}]
\t\t- –í—Å–µ —Ç–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏ –î–∞–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –±–æ–µ–≤–æ–º —Ä–µ–∂–∏–º–µ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371809aaae7d5e7bb377877}}]
\t\t- –ü–æ–ª–∏–Ω–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω–≤–µ–π–µ—Ä –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180c881dfca8b3c3e8c23}}]
\t\t### –ü—Ä–æ–±–ª–µ–º–∞ —Å VPN –¥–ª—è —Ä–µ–¥–∞–∫—Ü–∏–∏
\t\t- –†–µ–¥–∞–∫—Ç–æ—Ä—ã –Ω–µ –º–æ–≥—É—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –≤ ChatGPT –∏ –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∫ –î–∞–Ω–∏ –∑–∞ –ø–æ–º–æ—â—å—é [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180f3b60cd9b9b94e11a8}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371802792b7dc75870ea1ac}}]
\t\t- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**:
\t\t\t- OpenRouter - –º–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –º–æ–¥–µ–ª–∏ –±–µ–∑ VPN [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718084a0adf7f1079c5b26}}]
\t\t\t- Perplexity - –º–Ω–æ–≥–æ –º–æ–¥–µ–ª–µ–π, 900 —Ä—É–±–ª–µ–π –Ω–∞ –≥–æ–¥ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180998a3df43e16a137e3}}]
\t\t\t- –ê–º–Ω–µ–∑–∏—è - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180cabbf5ff4eff48c7da}}]
\t\t- **–†–µ—à–µ–Ω–∏–µ**: –ù–∞—á–∞—Ç—å —Å –ø–æ–∫—É–ø–∫–∏ VPN –Ω–∞ 25 –∞–∫–∫–∞—É–Ω—Ç–æ–≤, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∑–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç—å [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371808e9241d7dca2eece39}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180fa8519c8c00fb4345d}}]
\t\t- –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å avipin –Ω–∞ 50 —É—Å—Ç—Ä–æ–π—Å—Ç–≤ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180f0b115c877dac18dfe}}]
\t\t### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (–ü–æ–ª–∏–Ω–∞)
\t\t- –ü–æ–ª–∏–Ω–∞ –ø–æ–∫–∞–∑–∞–ª–∞ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –∞–≥–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ VE [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180f09375cc79868d3607}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718010b6e0e888523a9318}}]
\t\t- –ê–≥–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–Ω–Ω–µ—Ä—ã –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª–∏–º–∏—Ç–∞–º —Å–∏–º–≤–æ–ª–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ (–¥–æ 5 –ø–æ–ø—ã—Ç–æ–∫) [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718010b6e0e888523a9318}}]
\t\t- –í –∏—Ç–æ–≥–µ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –±–∞–Ω–Ω–µ—Ä—ã, –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–¥ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371804d8a4febc349956acd}}]
\t\t- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É —Å –∫—Ä–∏—Ç–∏–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —É–ª—É—á—à–µ–Ω–∏—é [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180b1869ecddfff37ca32}}]
\t\t- –ü–æ–ª–∏–Ω–∞ –ø–æ–¥–µ–ª–∏—Ç—Å—è –∫–æ–¥–æ–º –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371804d8a4febc349956acd}}]
\t\t### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–¥–ø–æ–ª–∏—Ç–∏–∫–∏
\t\t- –û–±—Å—É–∂–¥–∞–ª–∞—Å—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–µ–¥–ø–æ–ª–∏—Ç–∏–∫–∏ –≤ –∞–≥–µ–Ω—Ç–∞ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718026912bfbf61f99b58e}}]
\t\t- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—á–∞—Ç—å —Å 10 –∫–ª—é—á–µ–≤—ã—Ö –ø—É–Ω–∫—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ —Ä–∞–∑–¥—É—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718026912bfbf61f99b58e}}]
\t\t- –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –¥–µ–ª–∞—Ç—å –ø—Ä–æ–º—Ç—ã –∫–æ—Ä–æ—á–µ –∏ –ø—Ä–æ—â–µ, –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180229e1afb49d896b398}}]
\t\t### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø—Ä–æ–º—Ç–æ–≤
\t\t- –ü–æ–ª–∏–Ω–∞ –æ–±–Ω–æ–≤–∏–ª–∞ –¥–≤–∞ –ø—Ä–æ–º—Ç–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180c881dfca8b3c3e8c23}}]
\t\t- –ü–æ–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –ª–∏–º–∏—Ç–∞–º–∏ –Ω–µ –∏–¥–µ–∞–ª—å–Ω—ã, –Ω–æ —Å–º—ã—Å–ª–æ–≤–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ã –º–æ–≥—É—Ç –æ—Ü–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180c881dfca8b3c3e8c23}}]
\t\t- –í–∞–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–Ω—å—à–µ, —á–µ–º –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ —É–ª—É—á—à–∞—Ç—å –ø—Ä–æ–º—Ç—ã [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180f28ba0ccfba4b0fbb5}}]
\t\t### –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –¥–ª—è –±–æ–µ–≤—ã—Ö –∑–∞–¥–∞—á
\t\t- **–ó–∞–≥—Ä—É–∑–∫–∞ –±—Ä–∏—Ñ–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º**: –°–µ–π—á–∞—Å –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–±–∏–≤–∞—Ç—å, —á—Ç–æ –Ω–µ—É–¥–æ–±–Ω–æ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180c3bd99c6ea25418e36}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371809aaae7d5e7bb377877}}]
\t\t- –ö–æ–¥ –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —É–∂–µ –µ—Å—Ç—å [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180eea893fc3c4d20f8fc}}]
\t\t- –ß–µ–∫–±–æ–∫—Å –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞–¥–∞—á–∏ - –ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371809da832df56f6feb4a2}}]
\t\t### –ü–ª–∞–Ω—ã –∏ —Ü–µ–ª–∏ –Ω–∞ –≥–æ–¥
\t\t- –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ü–µ–ª—å - —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ–ª—é AI-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–æ 65% (—Å–µ–π—á–∞—Å –æ–∫–æ–ª–æ 50%) [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180178fa1db26edbbaa42}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180b4ac5cdc68fd345277}}]
\t\t- –° –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ —É–∂–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å —Ç–µ–∫—Å—Ç–∞–º–∏ –µ—â–µ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180178fa1db26edbbaa42}}]
\t\t- –û–±—Å—É–∂–¥–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∞–º–±–∏—Ü–∏–æ–∑–Ω—ã—Ö —Ü–µ–ª–µ–π: —Å–∏—Å—Ç–µ–º–∞ –Ω–µ–π–º–∏–Ω–≥–∞, –æ–±—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ —ç–∫—Å–ø–µ—Ä—Ç–∞ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180b4ac5cdc68fd345277}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180848cdec95f91df2693}}]
\t\t- –ó–∞–≤—Ç—Ä–∞ –ø–æ—Å–ª–µ —Å–∏–Ω–∫–∞ —Å –ù–∞—Å—Ç–µ–π –Ω—É–∂–Ω–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–∫–∏–Ω—É—Ç—å —Ü–µ–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞ —Å—Ä–µ–¥—ã [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180848cdec95f91df2693}}]
\t\t### –ò–¥–µ—è —Å–ª–µ–ø–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
\t\t- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç –°–µ—Ä–≥–µ—è –∏–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏: —Å–æ–∑–¥–∞—Ç—å —Ç–µ–ª–µ–≥—Ä–∞–º-–∫–∞–Ω–∞–ª/–±–æ—Ç–∞ —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏ [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180ecb338cdf722d52539}}]
\t\t- –†–µ–¥–∞–∫—Ç–æ—Ä—ã –∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã —É–≥–∞–¥—ã–≤–∞—é—Ç, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Ç–µ–∫—Å—Ç –∏–ª–∏ –Ω–µ—Ç [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180a29cf0e347cdb8a882}}]
\t\t- –û—Ü–µ–Ω–∫–∞ –±–µ–∑ –ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç–∏ "—ç—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç AI" [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371804d82d7e9dcf2ded6a2}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd63718005b736cc2e635067f9}}]
\t\t### –ü–æ–∏—Å–∫ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
\t\t- –ï—Å—Ç—å –ø–æ–∏—Å–∫ –ø–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∫–æ–Ω–≤–µ–π–µ—Ä [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180faafbffa23e72a4b95}}]
\t\t- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É –µ—Å—Ç—å, –Ω–æ –∑–∞–ø—Ä—è—Ç–∞–Ω –≤ UX [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180faafbffa23e72a4b95}}]
\t\t- –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º –≤ Figme –±—É–¥–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd6371806ea668cb6ce42ee040}}] [^{{https://www.notion.so/2edfa7fd637180b98715fa9f348f90f9#2edfa7fd637180ce9670f0a09225a948}}]
\t</summary>
\t<notes>
\t\t<empty-block/>
\t</notes>
\t<transcript>
\t\t–Ω–æ –ø–µ—Ä–≤—ã–π –±–∞—Ä–∞–±–∞–Ω –±—ã–ª –ª—É—á—à–µ –Ω–µ –∑–Ω–∞—é, –º–æ–∂–µ—Ç —Ç–∞–º —á—É—Ç—å –ø–æ–ø—Ä–æ—â–µ –ª–æ–≥–∏–∫–∞ –±—ã–ª–∞ —Ö–æ—Ç—è —è —Ç–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ–ª –Ω–∞ –±—Ä–∏—Ñ –Ω–∏—á–µ–≥–æ –ø–æ–¥–æ–±–Ω–æ–≥–æ —è —Ä–µ—à–∏–ª –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫ –æ—Ç—Ä–µ–∞–≥–∏—Ä—É–µ—Ç charge pt –Ω–∞ –º–æ–π –±—Ä–∏—Ñ –ù–µ –æ–±—É—á–µ–Ω–Ω—ã–π ChatGPT –ø—Ä–æ—Å—Ç–æ. –Ø –≤–æ—Ç –≤ —á–∞—Ç–∏–∫–µ –∑–∞–∫–∏–Ω—É–ª –±—Ä–∏—Ñ, –ø–æ—Å–º–æ—Ç—Ä–µ–ª, —á—Ç–æ –æ–Ω –º–Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç, –ø–æ–ø—Ä–æ—Å–∏–ª –µ–≥–æ –ø–æ—à–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ç—å, –æ–Ω —Ç–æ–∂–µ –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ –ø–æ–Ω—è–ª. –¢–æ –µ—Å—Ç—å, –∫–∞–∫ –±—É–¥—Ç–æ —Ç—É—Ç —Å–∞–º–∞ –º–µ—Ö–∞–Ω–∏–∫–∞ —Ç–∞–∫–∞—è –ø—Ä–æ–∫–ª—è—Ç–∞—è, –∑–Ω–∞–µ—à—å, —Å —ç—Ç–∏–º –±–∞—Ä–∞–±–∞–Ω–æ–º, —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –≤ –æ–¥–Ω–∏ –¥–∞—Ç—ã –ø–æ–∫—Ä—É—Ç–∏—Ç—å, –ø–æ–ª—É—á–∏—Ç—å –∫—ç—à–±—ç–∫.
\t\t<empty-block/>
\t</transcript>
</meeting-notes>
</content>
</page>"""


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—Å—Ç—Ä–µ—á–∏ —á–µ—Ä–µ–∑ MCP."""
    print("üöÄ –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MCP Notion...")
    
    try:
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
        settings = get_settings()
        print(f"‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        if not settings.telegram_bot_token:
            print("‚ùå –û—à–∏–±–∫–∞: TELEGRAM_BOT_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env")
            return
        
        if not settings.admin_chat_id:
            print("‚ùå –û—à–∏–±–∫–∞: ADMIN_CHAT_ID –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env")
            return
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–µ—Ä–≤–∏—Å—ã
        print("üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤...")
        context_loader = ContextLoader()
        await context_loader.sync_context_from_notion()
        rag_service = LocalRAG()
        notion_service = NotionService()
        ai_service = OllamaClient(context_loader=context_loader)
        telegram_bot = Bot(token=settings.telegram_bot_token)
        
        print("‚úÖ –°–µ—Ä–≤–∏—Å—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã")
        
        # 1. –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –≤—Å—Ç—Ä–µ—á—É –∏–∑ MCP –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        print("üîç –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—Å—Ç—Ä–µ—á–∏ –∏–∑ MCP –∫–æ–Ω—Ç–µ–Ω—Ç–∞...")
        block_id, title, content = notion_service._extract_last_meeting_from_mcp_content(
            MCP_CONTENT, 
            settings.notion_meeting_page_id or ""
        )
        
        if not content or len(content.strip()) < 50:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å –≤—Å—Ç—Ä–µ—á—É –∏–∑ MCP –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–¥–ª–∏–Ω–∞: {len(content) if content else 0})")
            return
        
        print(f"üìù Found latest entry: '{title}' ({len(content)} —Å–∏–º–≤–æ–ª–æ–≤)")
        
        # 2. –ò—â–µ–º –ø–æ—Ö–æ–∂–∏–µ –≤—Å—Ç—Ä–µ—á–∏ –≤ RAG
        print("üîé Searching similar meetings in RAG...")
        similar_meetings = rag_service.search_similar(content, n_results=3)
        context_texts = []
        for meeting in similar_meetings:
            context_texts.append(f"–°–∞–º–º–∞—Ä–∏: {meeting.get('summary', '')}\n–ó–∞–¥–∞—á–∏: {meeting.get('action_items', '')}")
        
        # 3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ AI
        print("üß† Analyzing with AI (Sudo Slava)...")
        analysis = await ai_service.analyze_meeting(
            content=content,
            context=context_texts,
            response_schema=MeetingAnalysis,
            sender_username=None
        )
        
        print("‚úÖ Analysis complete")
        
        # 4. –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram (HTML)
        from services.telegram_service import sanitize_html_for_telegram
        summary_clean = sanitize_html_for_telegram(analysis.summary_md)
        message_text = f"üìã <b>–°–∞–º–º–∞—Ä–∏ –≤—Å—Ç—Ä–µ—á–∏: {title}</b>\n\n{summary_clean}\n\n"
        
        if analysis.action_items:
            message_text += "<b>–ó–∞–¥–∞—á–∏:</b>\n"
            for i, item in enumerate(analysis.action_items[:10], 1):
                priority_emoji = {'High': 'üî¥', 'Medium': 'üü°', 'Low': 'üü¢'}.get(item.priority, '‚ö™')
                assignee_text = f" ({item.assignee})" if item.assignee else ""
                message_text += f"{i}. {priority_emoji} {item.text}{assignee_text}\n"
            if len(analysis.action_items) > 10:
                message_text += f"\n... –∏ –µ—â–µ {len(analysis.action_items) - 10} –∑–∞–¥–∞—á\n"
        
        if analysis.risk_assessment:
            message_text += f"\n‚ö†Ô∏è <b>RISKS:</b> {analysis.risk_assessment}\n"
        
        # 5. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
        print("üì§ Sending to Telegram...")
        await telegram_bot.send_message(
            chat_id=settings.admin_chat_id,
            text=message_text,
            parse_mode='HTML'
        )
        
        print("‚úÖ Sent to Telegram!")
        print("\nüéâ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∞–Ω–∞–ª–∏–∑–∞: {e}")
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()
        return


if __name__ == "__main__":
    asyncio.run(main())
