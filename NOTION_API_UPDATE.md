# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Notion API

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–æ

### 1. –í–µ—Ä—Å–∏—è API
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è **2025-09-03**
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `AsyncClient` —Å `notion_version="2025-09-03"`
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å `notion-client==2.2.1`

### 2. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

#### –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `_get_all_blocks_recursive()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º 100 –±–ª–æ–∫–æ–≤ –∑–∞ —Ä–∞–∑)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–∏—Ö –±–ª–æ–∫–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

#### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –±–ª–æ–∫–æ–≤
- ‚úÖ **–¢–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏**: paragraph, heading_1/2/3, bulleted_list_item, numbered_list_item
- ‚úÖ **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ**: to_do, toggle, callout, quote
- ‚úÖ **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ**: code, table, child_page, child_database
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏–∑ `rich_text` –º–∞—Å—Å–∏–≤–æ–≤

#### –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### 3. –†–∞–±–æ—Ç–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

#### –ú–µ—Ç–æ–¥ `get_ai_context_pages()`
- ‚úÖ –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –≤—Å–µ—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (ID, –Ω–∞–∑–≤–∞–Ω–∏–µ, URL, –¥–ª–∏–Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### 4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ API –≤–µ—Ä—Å–∏–∏ 2025-09-03

#### Data Sources
- ‚úÖ –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `get_database_data_sources()` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í –≤–µ—Ä—Å–∏–∏ 2025-09-03 –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã" –∏ "data sources"
- ‚úÖ –ú–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ data sources –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìã –ù–æ–≤—ã–µ API endpoints

### GET /api/notion/context/pages
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ AI-Context.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `parent_page_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `include_content` (default: true) - –í–∫–ª—é—á–∞—Ç—å –ª–∏ –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- `recursive` (default: true) - –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–û—Ç–≤–µ—Ç:**
```json
{
  "pages": [
    {
      "id": "page_id",
      "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
      "url": "https://notion.so/...",
      "content": "–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã...",
      "content_length": 1234
    }
  ],
  "count": 5,
  "total_content_length": 5678
}
```

### GET /api/notion/pages/{page_id}/content
–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã Notion.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `include_metadata` (default: false) - –í–∫–ª—é—á–∞—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–û—Ç–≤–µ—Ç:**
```json
{
  "page_id": "page_id",
  "content": "–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç...",
  "content_length": 1234
}
```

### GET /api/notion/databases/{database_id}/data-sources
–ü–æ–ª—É—á–∞–µ—Ç data sources –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è API –≤–µ—Ä—Å–∏–∏ 2025-09-03).

**–û—Ç–≤–µ—Ç:**
```json
{
  "database_id": "database_id",
  "data_sources": [
    {
      "id": "data_source_id",
      "name": "Data Source Name",
      ...
    }
  ],
  "count": 1
}
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤
```python
async def _get_all_blocks_recursive(self, block_id: str) -> List[Dict[str, Any]]:
    # 1. –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –±–ª–æ–∫–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
    # 2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º has_children
    # 3. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–æ–ª—É—á–∞–µ–º –¥–æ—á–µ—Ä–Ω–∏–µ –±–ª–æ–∫–∏
```

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –±–ª–æ–∫–æ–≤
```python
async def _extract_text_from_block(self, block: Dict[str, Any]) -> str:
    # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –±–ª–æ–∫–æ–≤:
    # - –¢–µ–∫—Å—Ç–æ–≤—ã–µ (paragraph, heading, list items)
    # - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ (to_do, toggle, callout)
    # - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ (code, table, child_page)
```

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### API –≤–µ—Ä—Å–∏—è 2025-09-03
- **Breaking change**: –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ø–µ—Ä—å —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ data sources
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `data_source_id` –≤–º–µ—Å—Ç–æ `database_id`
- –ú–µ—Ç–æ–¥ `get_database_data_sources()` –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ ID

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–∫—É—Ä—Å–∏—é - –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é
- –ú–∞–∫—Å–∏–º—É–º 100 –±–ª–æ–∫–æ–≤ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å (–ø–∞–≥–∏–Ω–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞)
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–∏–ø—ã –±–ª–æ–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, nested databases) —Ç—Ä–µ–±—É—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `include_content=False` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```python
notion = NotionService()
content = await notion.get_page_content("page_id", include_metadata=True)
```

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ AI-Context
```python
pages = await notion.get_ai_context_pages(
    parent_page_id="parent_id",
    include_content=True,
    recursive=True
)
```

### –ü–æ–ª—É—á–∏—Ç—å data sources –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```python
data_sources = await notion.get_database_data_sources("database_id")
```

## üìö –°—Å—ã–ª–∫–∏

- [Notion API Overview](https://developers.notion.com/docs/getting-started)
- [Upgrading to Version 2025-09-03](https://developers.notion.com/docs/upgrade-guide-2025-09-03)
- [Retrieve block children](https://developers.notion.com/reference/get-block-children)
- [Notion MCP](https://www.notion.com/help/notion-mcp)
