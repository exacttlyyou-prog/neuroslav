# Улучшения архитектуры: Чат-интерфейс с агентами

## Проблемы текущей архитектуры

1. **Отдельные workflows** - нужно выбирать тип действия вручную
2. **Дизайн фронта** - не автоматизирован, требует ручного выбора
3. **AI саммари не подгружаются** - проблема с отображением результатов
4. **RAG работает**, но не интегрирован в общий поток

## Предлагаемая архитектура: Чат с агентами

### Концепция

Единый чат-интерфейс, где пользователь просто пишет, а агенты сами решают:
- Это задача? → TaskAgent
- Это пожелание/идея? → KnowledgeAgent
- Это сообщение для отложенной отправки? → MessageAgent
- Это нужно сделать репорт встречи? → MeetingAgent (с кнопкой)
- Это вопрос по базе знаний? → RAGAgent

### Архитектура агентов

```
User Input
    ↓
AgentRouter (классификация через LLM)
    ↓
┌───┴───┬──────┬──────────┬────────┐
│       │      │          │        │
Task  Meeting Message Knowledge  RAG
Agent  Agent  Agent     Agent    Agent
```

### Компоненты

1. **AgentRouter** - главный роутер, классифицирует вход
2. **TaskAgent** - обработка задач
3. **MeetingAgent** - обработка встреч (с кнопкой "Сделать репорт")
4. **MessageAgent** - отложенные сообщения
5. **KnowledgeAgent** - сохранение знаний
6. **RAGAgent** - поиск по базе знаний

## Новый дизайн фронта

### Чат-интерфейс (главная страница)

- Большое поле ввода внизу
- История сообщений в центре
- Боковая панель с быстрыми действиями:
  - "Обработать последнюю встречу" (кнопка)
  - "Поиск по знаниям"
  - "Мои задачи"
  - "История встреч"

### Автоматизация

- Автоматическое определение типа сообщения
- Автоматическая обработка без выбора типа
- Показ статуса обработки в реальном времени
- Автоматическое сохранение в нужные места (Notion, RAG, БД)

## План реализации

### Фаза 1: AgentRouter и базовая классификация

1. Создать `AgentRouter` сервис
2. Классификация через LLM (Ollama)
3. Маршрутизация к нужному агенту

### Фаза 2: Чат-интерфейс

1. Новый компонент `ChatInterface`
2. История сообщений
3. Интеграция с AgentRouter

### Фаза 3: Улучшение RAG

1. Интеграция RAG в каждый агент
2. Автоматический поиск контекста перед обработкой
3. Сохранение результатов в RAG

### Фаза 4: Исправление проблем

1. Исправить подгрузку AI саммари
2. Улучшить отображение результатов
3. Добавить индикаторы загрузки
